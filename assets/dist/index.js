(()=>{"use strict";var e={338:(e,t,n)=>{var a=n(795);t.H=a.createRoot,a.hydrateRoot},795:e=>{e.exports=window.ReactDOM}},t={};const n=window.React;var a=function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}(338);const r=({integrations:e,settings:t,onIntegrationClick:a})=>(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"}},(0,n.createElement)("span",{className:"dashicons dashicons-rss",style:{fontSize:"36px",marginRight:"10px"}}),(0,n.createElement)("h1",{style:{margin:0}},"EchoDash"),(0,n.createElement)("a",{href:"https://docs.echodash.com",target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"auto"},className:"button button-link"},"Documentation →")),(0,n.createElement)("div",{style:{backgroundColor:"white",border:"1px solid #c3c4c7",borderRadius:"8px",padding:"30px",marginBottom:"30px",display:"flex",gap:"30px"}},(0,n.createElement)("div",{style:{flex:1}},(0,n.createElement)("h2",{style:{marginTop:0}},"Welcome to EchoDash"),(0,n.createElement)("p",{style:{color:"#646970",marginBottom:"20px"}},"EchoDash is a service for tracking real-time events on your WordPress site. It's free and easy to use."),(0,n.createElement)("p",{style:{marginBottom:"8px"}},"To get started, ",(0,n.createElement)("a",{href:"#",style:{color:"#2271b1"}},"create an endpoint in your EchoDash account"),", and copy the URL into the field below."),(0,n.createElement)("div",{style:{marginTop:"20px"}},(0,n.createElement)("label",{htmlFor:"endpoint-url",style:{display:"block",marginBottom:"8px"}},(0,n.createElement)("strong",null,"URL")),(0,n.createElement)("input",{type:"text",id:"endpoint-url",className:"regular-text",placeholder:"https://example.com/",value:t.endpoint||"",style:{width:"100%"}}))),(0,n.createElement)("div",{style:{width:"400px",height:"225px",backgroundColor:"#f0f0f1",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}},(0,n.createElement)("div",{style:{width:"60px",height:"60px",backgroundColor:"rgba(255,255,255,0.9)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},(0,n.createElement)("span",{className:"dashicons dashicons-controls-play",style:{fontSize:"30px",marginLeft:"3px"}})))),(0,n.createElement)("div",{style:{backgroundColor:"white",border:"1px solid #c3c4c7",borderRadius:"8px",padding:"20px"}},(0,n.createElement)("h2",{style:{marginTop:0,marginBottom:"20px"}},"Integrations"),(0,n.createElement)("div",{style:{display:"flex",flexDirection:"column",gap:"1px"}},e.map(e=>(0,n.createElement)("div",{key:e.slug,style:{display:"flex",alignItems:"center",padding:"16px",backgroundColor:"#f6f7f7",borderRadius:"4px",marginBottom:"8px"}},(0,n.createElement)("div",{style:{width:"40px",height:"40px",backgroundColor:"wordpress"===e.slug?"#2271b1":"#FF6900",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"16px"}},(0,n.createElement)("span",{className:`dashicons dashicons-${e.icon}`,style:{fontSize:"24px",color:"white"}})),(0,n.createElement)("div",{style:{flex:1}},(0,n.createElement)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"normal"}},e.name),(0,n.createElement)("span",{style:{color:"#646970",fontSize:"13px"}},e.triggerCount," ",1===e.triggerCount?"Trigger":"Triggers")),(0,n.createElement)("div",{style:{display:"flex",gap:"10px"}},(0,n.createElement)("button",{className:"button button-secondary",onClick:()=>a(e.slug)},"Manage"),(0,n.createElement)("button",{className:"button button-primary"},"+ Add Trigger"))))))),o=({integration:e,triggers:t,onBack:a,onAddTrigger:r})=>(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"}},(0,n.createElement)("span",{className:"dashicons dashicons-rss",style:{fontSize:"36px",marginRight:"10px"}}),(0,n.createElement)("h1",{style:{margin:0}},"EchoDash"),(0,n.createElement)("a",{href:"https://docs.echodash.com",target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"auto"},className:"button button-link"},"Documentation →")),(0,n.createElement)("div",{style:{marginBottom:"20px"}},(0,n.createElement)("button",{onClick:a,className:"button button-link",style:{padding:0}},"Integrations"),(0,n.createElement)("span",{style:{margin:"0 8px",color:"#646970"}},"/"),(0,n.createElement)("span",null,e.name)),(0,n.createElement)("div",{style:{backgroundColor:"white",border:"1px solid #c3c4c7",borderRadius:"8px",padding:"30px",marginBottom:"30px"}},(0,n.createElement)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"}},(0,n.createElement)("div",{style:{width:"48px",height:"48px",backgroundColor:"wordpress"===e.slug?"#2271b1":"#FF6900",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"16px"}},(0,n.createElement)("span",{className:`dashicons dashicons-${e.icon}`,style:{fontSize:"28px",color:"white"}})),(0,n.createElement)("div",null,(0,n.createElement)("h1",{style:{margin:0,fontSize:"24px"}},e.name),(0,n.createElement)("p",{style:{margin:0,color:"#646970"}},e.description||"Configure triggers for this integration")),(0,n.createElement)("button",{className:"button button-primary",onClick:r,style:{marginLeft:"auto"}},"+ Add Trigger"))),(0,n.createElement)("div",{style:{backgroundColor:"white",border:"1px solid #c3c4c7",borderRadius:"8px",padding:"20px"}},(0,n.createElement)("h2",{style:{marginTop:0,marginBottom:"20px"}},"Triggers"),0===t.length?(0,n.createElement)("div",{style:{textAlign:"center",padding:"60px 20px",color:"#646970"}},(0,n.createElement)("div",{style:{width:"48px",height:"48px",backgroundColor:"#FF6900",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"}},(0,n.createElement)("span",{className:`dashicons dashicons-${e.icon}`,style:{fontSize:"28px",color:"white"}})),(0,n.createElement)("h3",{style:{marginBottom:"10px"}},"Add your first ",e.name," trigger"),(0,n.createElement)("p",{style:{marginBottom:"20px"}},"Accumsan augue sapien lorem blandit leo. In fringilla aliquam mattis phasellus.",(0,n.createElement)("br",null),"Feugiat feugiat risus cursus tempor tortor."),(0,n.createElement)("button",{className:"button button-primary",onClick:r},"+ Add Trigger")):(0,n.createElement)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},t.map((e,t)=>(0,n.createElement)("div",{key:e.id||t,style:{display:"flex",alignItems:"center",padding:"16px",backgroundColor:"#f6f7f7",borderRadius:"4px"}},(0,n.createElement)("span",{className:"dashicons dashicons-menu",style:{color:"#646970",marginRight:"12px",cursor:"grab"}}),(0,n.createElement)("div",{style:{flex:1}},(0,n.createElement)("div",{style:{fontWeight:"bold",marginBottom:"4px"}},"Form Submitted"),(0,n.createElement)("div",{style:{color:"#646970",fontSize:"14px"}},e.name)),(0,n.createElement)("div",{style:{display:"flex",gap:"10px"}},(0,n.createElement)("button",{className:"button button-secondary"},"Send Test"),(0,n.createElement)("button",{className:"button button-secondary"},"Edit"),(0,n.createElement)("button",{className:"button button-link-delete"},(0,n.createElement)("span",{className:"dashicons dashicons-trash"})))))))),l=({options:e,onSelect:t,isOpen:a,onClose:r,buttonRef:o})=>{const l=(0,n.useRef)(null),[i,s]=(0,n.useState)({top:0,left:0});return(0,n.useEffect)(()=>{if(a&&o.current&&l.current){const e=o.current.getBoundingClientRect(),t=l.current.getBoundingClientRect();let n=e.bottom+window.scrollY+5,a=e.left+window.scrollX;a+t.width>window.innerWidth&&(a=e.right+window.scrollX-t.width),n+t.height>window.innerHeight+window.scrollY&&(n=e.top+window.scrollY-t.height-5),s({top:n,left:a})}},[a,o]),(0,n.useEffect)(()=>{const e=e=>{l.current&&!l.current.contains(e.target)&&o.current&&!o.current.contains(e.target)&&r()};if(a)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a,r,o]),a?(0,n.createElement)("div",{ref:l,style:{position:"fixed",top:i.top,left:i.left,backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:1e4,minWidth:"300px",maxHeight:"300px",overflowY:"auto"}},e.map((a,o)=>(0,n.createElement)("div",{key:o,style:{borderBottom:o<e.length-1?"1px solid #eee":"none"}},(0,n.createElement)("div",{style:{padding:"8px 12px",backgroundColor:"#f7f7f7",fontWeight:"bold",fontSize:"13px",color:"#555",borderBottom:"1px solid #eee"}},a.name),a.options.map((e,o)=>(0,n.createElement)("div",{key:o,onClick:()=>{return n=a.type,o=e.meta,t(`{${n}:${o}}`),void r();var n,o},style:{padding:"8px 12px",cursor:"pointer",borderBottom:o<a.options.length-1?"1px solid #f0f0f0":"none",fontSize:"13px",transition:"background-color 0.1s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"}},(0,n.createElement)("div",{style:{fontWeight:"500",marginBottom:"2px"}},`{${a.type}:${e.meta}}`),(0,n.createElement)("div",{style:{color:"#666",fontSize:"12px"}},e.placeholder),(0,n.createElement)("div",{style:{color:"#999",fontSize:"11px",marginTop:"2px"}},"Preview: ",String(e.preview)))))),0===e.length&&(0,n.createElement)("div",{style:{padding:"12px",color:"#666",fontSize:"13px",textAlign:"center"}},"No merge tags available")):null},i=({isOpen:e,onClose:t,onSave:a,integration:r})=>{const o=r.availableTriggers||[{id:"form_submitted",name:"Form Submitted",description:"Triggered each time a form is submitted."}],i=o[0],[s,c]=(0,n.useState)(i?.id||""),[d,p]=(0,n.useState)(i?.defaultEvent?.name||i?.name||""),[m,g]=(0,n.useState)((()=>{if(i?.defaultEvent?.mappings&&"object"==typeof i.defaultEvent.mappings){const e=Object.entries(i.defaultEvent.mappings).map(([e,t])=>({key:e,value:String(t)}));return e.push({key:"",value:""}),e}return[{key:"user_name",value:"{user_name}"},{key:"user_id",value:"{user_id}"},{key:"",value:""}]})()),[u,y]=(0,n.useState)(!1),[x,f]=(0,n.useState)(null),h=(0,n.useRef)(null),E=(0,n.useRef)([]);if((0,n.useEffect)(()=>{E.current=E.current.slice(0,m.length)},[m.length]),!e)return null;const b=(e,t,n)=>{const a=[...m];a[e][t]=n,g(a)},v=()=>{g([...m,{key:"",value:""}])};return(0,n.createElement)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3}},(0,n.createElement)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"500px",maxHeight:"90vh",overflow:"auto"}},(0,n.createElement)("div",{style:{padding:"20px 24px",borderBottom:"1px solid #ddd",display:"flex",alignItems:"center",justifyContent:"space-between"}},(0,n.createElement)("div",{style:{display:"flex",alignItems:"center"}},(0,n.createElement)("div",{style:{width:"32px",height:"32px",backgroundColor:"#FF6900",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"}},(0,n.createElement)("span",{className:"dashicons dashicons-"+("gravity-forms"===r.slug?"feedback":"admin-plugins"),style:{fontSize:"18px",color:"white"}})),(0,n.createElement)("div",null,(0,n.createElement)("h2",{style:{margin:0,fontSize:"18px"}},"Add Trigger"),(0,n.createElement)("p",{style:{margin:0,color:"#646970",fontSize:"14px"}},"Create a trigger for ",r.name))),(0,n.createElement)("button",{onClick:t,style:{background:"none",border:"none",cursor:"pointer",padding:"4px"}},(0,n.createElement)("span",{className:"dashicons dashicons-no-alt"}))),(0,n.createElement)("div",{style:{padding:"24px"}},(0,n.createElement)("div",{style:{marginBottom:"20px"}},(0,n.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"}},"Trigger"),(0,n.createElement)("select",{value:s,onChange:e=>(e=>{c(e);const t=o.find(t=>t.id===e);if(t&&(p(t.defaultEvent?.name||t.name),t.defaultEvent?.mappings&&"object"==typeof t.defaultEvent.mappings)){const e=Object.entries(t.defaultEvent.mappings).map(([e,t])=>({key:e,value:String(t)}));e.push({key:"",value:""}),g(e)}})(e.target.value),style:{width:"100%",padding:"8px"}},o.map(e=>(0,n.createElement)("option",{key:e.id,value:e.id},e.name))),s&&(0,n.createElement)("div",{style:{backgroundColor:"#e7f3ff",padding:"12px",borderRadius:"4px",marginTop:"8px",display:"flex",alignItems:"flex-start"}},(0,n.createElement)("span",{className:"dashicons dashicons-info",style:{color:"#0073aa",marginRight:"8px",marginTop:"2px"}}),(0,n.createElement)("span",{style:{fontSize:"14px"}},o.find(e=>e.id===s)?.description||"No description available."))),(0,n.createElement)("div",{style:{marginBottom:"20px"}},(0,n.createElement)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px"}},"Payload"),(0,n.createElement)("p",{style:{color:"#646970",fontSize:"14px",marginBottom:"16px"}},"Configure the data to send when this trigger fires."),(0,n.createElement)("div",{style:{marginBottom:"16px"}},(0,n.createElement)("label",{style:{display:"block",marginBottom:"4px",fontWeight:"bold"}},"Name:"),(0,n.createElement)("input",{type:"text",value:d,onChange:e=>p(e.target.value),placeholder:"Contact Form Submitted",style:{width:"100%",padding:"8px"}}),(0,n.createElement)("button",{ref:h,type:"button",onClick:()=>f({type:"name",index:-1}),style:{background:"none",border:"none",color:"#646970",cursor:"pointer",fontSize:"12px",padding:"4px 0"}},"{...}")),m.map((e,t)=>(0,n.createElement)("div",{key:t,style:{display:"flex",gap:"8px",marginBottom:"8px",alignItems:"center"}},(0,n.createElement)("div",{style:{flex:1}},(0,n.createElement)("label",{style:{display:"block",fontSize:"12px",marginBottom:"2px"}},"Key:"),(0,n.createElement)("input",{type:"text",value:e.key,onChange:e=>b(t,"key",e.target.value),style:{width:"100%",padding:"6px"}})),(0,n.createElement)("div",{style:{flex:1}},(0,n.createElement)("label",{style:{display:"block",fontSize:"12px",marginBottom:"2px"}},"Value:"),(0,n.createElement)("input",{type:"text",value:e.value,onChange:e=>b(t,"value",e.target.value),style:{width:"100%",padding:"6px"}})),(0,n.createElement)("div",{style:{display:"flex",gap:"4px",alignItems:"flex-end",paddingBottom:"2px"}},(0,n.createElement)("button",{type:"button",onClick:v,style:{background:"none",border:"none",color:"#646970",cursor:"pointer",padding:"4px"}},(0,n.createElement)("span",{className:"dashicons dashicons-plus-alt"})),m.length>1&&(0,n.createElement)("button",{type:"button",onClick:()=>(e=>{if(m.length>1){const t=m.filter((t,n)=>n!==e);g(t)}})(t),style:{background:"none",border:"none",color:"#646970",cursor:"pointer",padding:"4px"}},(0,n.createElement)("span",{className:"dashicons dashicons-minus"}))),(0,n.createElement)("button",{ref:e=>{E.current&&(E.current[t]=e)},type:"button",onClick:()=>f({type:"value",index:t}),style:{background:"none",border:"none",color:"#646970",cursor:"pointer",fontSize:"12px",alignSelf:"flex-end",paddingBottom:"6px"}},"{...}")))),(0,n.createElement)("div",{style:{marginBottom:"20px"}},(0,n.createElement)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"}},(0,n.createElement)("input",{type:"checkbox",checked:u,onChange:e=>y(e.target.checked),style:{marginRight:"8px"}}),(0,n.createElement)("span",{className:"dashicons dashicons-admin-tools",style:{marginRight:"6px"}}),"Send Test"))),x&&(0,n.createElement)(l,{options:(()=>{const e=o.find(e=>e.id===s);return e?.options||[]})(),onSelect:e=>{if("name"===x?.type)p(t=>t+e);else if("value"===x?.type){const t=x.index;b(t,"value",m[t].value+e)}f(null)},isOpen:!0,onClose:()=>f(null),buttonRef:"name"===x.type?h:{current:E.current[x.index]}}),(0,n.createElement)("div",{style:{padding:"16px 24px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"10px"}},(0,n.createElement)("button",{onClick:t,className:"button button-secondary"},"Cancel"),(0,n.createElement)("button",{onClick:()=>{const e={trigger:s,name:d,mappings:m.filter(e=>e.key&&e.value),sendTest:u};a(e)},className:"button button-primary",disabled:!s},"Add Trigger"))))},s=()=>{const[e,t]=(0,n.useState)("list"),[a,l]=(0,n.useState)(null),[s,c]=(0,n.useState)(!1),[d,p]=(0,n.useState)(window.ecdReactData?.triggers||{}),[m,g]=(0,n.useState)(window.ecdReactData?.integrations||[]),u=window.ecdReactData||{settings:{},integrations:[],triggers:{},nonce:"",apiUrl:"",i18n:{}},y=m.find(e=>e.slug===a);return(0,n.createElement)("div",{className:"wrap"},"list"===e?(0,n.createElement)(r,{integrations:m,settings:u.settings,onIntegrationClick:e=>{l(e),t("detail")}}):y&&(0,n.createElement)(o,{integration:y,triggers:d[a]||[],onBack:()=>{t("list"),l(null)},onAddTrigger:()=>{c(!0)}}),s&&y&&(0,n.createElement)(i,{isOpen:s,onClose:()=>c(!1),onSave:async e=>{console.log("Saving trigger:",e);try{const t=await fetch(`${u.apiUrl}integrations/${a}/triggers`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":u.nonce},body:JSON.stringify({trigger:e.trigger,name:e.name,mappings:e.mappings,send_test:e.sendTest})});if(t.ok){const n=await t.json();if(console.log("Trigger saved successfully:",n),a){const t=d[a]||[];t.push({id:n.id||Date.now().toString(),name:e.name,trigger:e.trigger,enabled:!0}),p({...d,[a]:t}),g(e=>e.map(e=>e.slug===a?{...e,triggerCount:e.triggerCount+1,enabled:!0}:e))}c(!1)}else{const e=await t.json();console.error("Failed to save trigger:",e),alert("Failed to save trigger. Please try again.")}}catch(e){console.error("Error saving trigger:",e),alert("Error saving trigger. Please check your connection and try again.")}},integration:y}))};function c(){try{const e=document.getElementById("echodash-react-app");if(e){(0,a.H)(e).render((0,n.createElement)(s,null)),e.classList.add("loaded");const t=document.getElementById("echodash-loading");t&&(t.style.display="none")}else console.error("EchoDash: Container #echodash-react-app not found")}catch(e){console.error("EchoDash: Error during initialization:",e)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()})();
//# sourceMappingURL=index.js.map